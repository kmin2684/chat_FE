{"version":3,"sources":["others/shared_functions.js","components/Spinner/Spinner.jsx","store/userInfo-slice.js","others/shared_vars.js","components/Login/Login.jsx","components/Registration/Registration.jsx","icons/x-lg.svg","icons/info.svg","store/status-slice.js","components/Friend/Friend.jsx","components/ChatWindowModal/ChatWindowModal.jsx","components/ChatWindow/ChatWindow.jsx","icons/group-icon.svg","icons/arrow-left.svg","components/NewChat/NewChat.jsx","components/AddFriend/AddFriend.jsx","components/Chat/Chat.jsx","components/ChatPeopleList/ChatPeopleList.jsx","icons/chat-fill.svg","icons/people-fill.svg","components/ChatPeopleToggle/ChatPeopleToggle.jsx","icons/log-out.svg","icons/pencil-fill.svg","icons/person-plus-fill.svg","components/Main/Main.jsx","store/index.js","App.js","store/userInfo-actions.js","reportWebVitals.js","index.js"],"names":["StringToColor","string","sum","charCodeAt","MobileViewSide","viewSide","show","hide","console","log","sideDisplayed","document","querySelector","originalClassList","classList","value","split","filter","e","trim","length","uniqueClassList","Set","modifiedClassList","remove","add","sideHidden","SaveUserInfo","userInfo","Storage","localStorage","ChatUserInfo","JSON","stringify","QueryStringGenerator","section","members","groupName","friends","query","URLSearchParams","append","forEach","member","includes","toString","Spinner","className","role","userInfoSlice","createSlice","name","initialState","username","token","isLoading","reducers","setUserInfo","state","action","payload","userInfoActions","actions","http_url","Login","loggedIn","history","useHistory","dispatch","useDispatch","useState","setUsername","password","setPassword","setIsLoading","onChange","event","type","target","VisitorSignIn","undefined","fetch","method","headers","body","then","response","json","data","non_field_errors","alert","to","onSubmit","preventDefault","TextField","id","placeholder","autoComplete","Button","variant","onClick","push","Registration","password2","setPassword2","keys","Object","find","key","error","SortByTime","a","b","Date","last_message","time","getTime","statusSlice","chats","currentChat","chatHistory","setChats","sort","addChat","setFriends","addFriend","setCurrentChat","setChatHistory","statusActions","Friend","friend","onClickFriend","checked","changeCheck","isFriend","style","backgroundColor","disabled","ChatWindowModal","prop","useSelector","status","Dialog","open","modalOpen","onClose","setModalOpenProp","container","position","BackdropProps","componentsProps","padding","DialogTitle","map","ChatWindow","inputOn","socket","newChatData","mobileViewSide","room_id","useParams","chatTitle","setChatTitle","content","setContent","scroll","useRef","setDisabled","setModalOpen","useEffect","current","scrollTop","scrollHeight","displayedChat","chat","GetChatTitle","newChatMembers","messages","message","sender","datetime","src","xIcon","alt","infoIcon","ref","url","send","sendMessage","autoFocus","sections","NewChat","location","useLocation","queryParams","search","queryParamsSection","get","queryParamsMembers","getAll","queryParamsGroupName","setSection","setGroupName","checkedUsers","setCheckedUsers","newChat","setNewChatData","prev","new_message","groupIcon","add_participants","arrowLeftIcon","user","concat","add_title","JumpToSendMessage","required","send_message","AddFriend","setQuery","suggestions","setSuggestions","new_suggestion","ok","suggestion","searchResult","formatTime","timeInput","month","getMonth","getFullYear","getDate","getHours","getMinutes","Chat","path","chatName","otherMembers","slice","overflow","ChatPeopleList","showChat","setChatHistoryProp","ChatPeopleToggle","ChatPeopleSwitch","chat_fill","people_fill","Main","rooms","setShowChat","profilePage","ProfileOn","window","reload","catch","logoutIcon","profile","display","personPlusIcon","pencilIcon","store","configureStore","reducer","App","setSocket","chat_id","getState","fetchData","Authorization","Error","tempSocket","W3CWebSocket","ws_url","close","storedInfo","parse","userData","authorization","replace","updatedChats","onopen","onmessage","room","exact","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.aa0eb8f7.chunk.js","sourcesContent":["export function convertTZ(date, tzString) {\r\n  return new Date(\r\n    (typeof date === \"string\" ? new Date(date) : date).toLocaleString(\"en-US\", {\r\n      timeZone: tzString,\r\n    })\r\n  );\r\n}\r\n\r\nexport function StringToColor(string) {\r\n  let colorMap = {\r\n    0: \"#313E50\",\r\n    1: \"#924C5D\",\r\n    2: \"#C5867A\",\r\n    3: \"#E1915E\",\r\n    4: \"#E17F5E\",\r\n    5: \"#85A47A\",\r\n  };\r\n\r\n  let sum = 0;\r\n  for (let char of string) {\r\n    sum += char.charCodeAt(0);\r\n  }\r\n\r\n  return colorMap[sum % 6];\r\n}\r\n\r\nexport function MobileViewSide(viewSide) {\r\n  let show;\r\n  let hide;\r\n  if (viewSide === \"left\") {\r\n    show = \"left\";\r\n    hide = \"right\";\r\n  } else if (viewSide === \"right\") {\r\n    show = \"right\";\r\n    hide = \"left\";\r\n  } else {\r\n    console.log(\"invalide viewSide for MobileViewSide function\");\r\n    return;\r\n  }\r\n  // add className of \"ShowIfMobile\" to the element that will be displayed\r\n  let sideDisplayed = document.querySelector(`.${show}`);\r\n  let originalClassList = sideDisplayed.classList.value\r\n    .split(/(\\s+)/)\r\n    .filter(function (e) {\r\n      return e.trim().length > 0;\r\n    });\r\n  let uniqueClassList = [...new Set(originalClassList)];\r\n  let modifiedClassList = uniqueClassList.filter(\r\n    (e) => !(e === \"HideIfMobile\" || e === \"ShowIfMobile\")\r\n  );\r\n  sideDisplayed.classList.remove(...originalClassList);\r\n  sideDisplayed.classList.add(...[...modifiedClassList, \"ShowIfMobile\"]);\r\n\r\n  // add className of \"HideIfMobile\" to the element that will be displayed\r\n  let sideHidden = document.querySelector(`.${hide}`);\r\n  if (!sideHidden) {\r\n    console.log(\"no side to hide\");\r\n    return;\r\n  }\r\n  console.log(\"side hidden\", sideHidden);\r\n  originalClassList = sideHidden?.classList?.value\r\n    ?.split(/(\\s+)/)\r\n    .filter(function (e) {\r\n      return e.trim().length > 0;\r\n    });\r\n  uniqueClassList = [...new Set(originalClassList)];\r\n  modifiedClassList = uniqueClassList.filter(\r\n    (e) => !(e === \"HideIfMobile\" || e === \"ShowIfMobile\")\r\n  );\r\n  sideHidden.classList.remove(...originalClassList);\r\n  sideHidden.classList.add(...[...modifiedClassList, \"HideIfMobile\"]);\r\n  return;\r\n}\r\n\r\nexport function SaveUserInfo(userInfo) {\r\n  if (typeof Storage !== \"undefined\") {\r\n    if (!userInfo) localStorage.ChatUserInfo = null;\r\n    else localStorage.ChatUserInfo = JSON.stringify(userInfo);\r\n    console.log(\"user info saved in local storage\");\r\n  } else {\r\n    console.log(\"unable to use localStorage\");\r\n  }\r\n}\r\n\r\nexport function getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height,\r\n  };\r\n}\r\n\r\nexport function GetChatTitle(currentChat, chats, userInfo) {\r\n  let displayedChat;\r\n  if (!currentChat) return undefined;\r\n  displayedChat = chats?.find((chat) => chat.id == currentChat);\r\n\r\n  if (displayedChat?.name) return displayedChat.name;\r\n  else {\r\n    return displayedChat?.members?.find(\r\n      (member) => member !== userInfo?.username\r\n    );\r\n  }\r\n}\r\n\r\nexport function QueryStringGenerator(section, members, groupName, friends) {\r\n  let query = new URLSearchParams();\r\n  if (section) {\r\n    query.append(\"section\", section);\r\n  }\r\n\r\n  members.forEach((member) => {\r\n    if (friends.includes(member)) query.append(\"members\", member);\r\n  });\r\n\r\n  if (groupName?.trim()) query.append(\"group_name\", groupName);\r\n  return query.toString();\r\n}\r\n","export default function Spinner () {\r\n    return  <>\r\n    <div className=\"spinner-border\" role=\"status\">\r\n        <span className=\"sr-only\">Loading...</span>\r\n    </div>\r\n</>;\r\n}\r\n","import { createSlice } from \"@reduxjs/toolkit\";\r\n\r\nconst initialState = { username: null, token: null, isLoading: true };\r\n\r\nconst userInfoSlice = createSlice({\r\n  name: \"userInfo\",\r\n  initialState,\r\n  reducers: {\r\n    setUserInfo(state, action) {\r\n      state.username = action.payload.username;\r\n      state.token = action.payload.token;\r\n      state.isLoading = action.payload.isLoading\r\n        ? action.payload.isLoading\r\n        : action.payload.isLoading === false\r\n        ? action.payload.isLoading\r\n        : state.isLoading;\r\n    },\r\n  },\r\n});\r\n\r\nexport const userInfoActions = userInfoSlice.actions;\r\n\r\nexport default userInfoSlice;\r\n","// const http_url = \"http://127.0.0.1:8000\";\r\n\r\n// const ws_url = \"ws://127.0.0.1:8000\";\r\n\r\nconst http_url = \"https://mk-chat-be.herokuapp.com\";\r\nconst ws_url = \"wss://mk-chat-be.herokuapp.com\";\r\n\r\nexport { http_url, ws_url };\r\n","import React, { useState} from \"react\";\r\nimport {SaveUserInfo} from \"../../others/shared_functions\";\r\nimport Spinner from '../Spinner/Spinner';\r\nimport { useDispatch } from \"react-redux\";\r\nimport {userInfoActions} from \"../../store/userInfo-slice\";\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport {\r\n    Redirect,\r\n    useHistory\r\n  } from \"react-router-dom\";\r\n\r\nimport { http_url} from \"../../others/shared_vars\";\r\n\r\nexport default function Login({loggedIn}) {\r\n    let history = useHistory();\r\n    const dispatch = useDispatch(); \r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    \r\n    function onSubmit(event) {\r\n        event.preventDefault();\r\n        setIsLoading(true);\r\n        fetch( http_url + '/chat_app/api-token-auth/', {\r\n            method: 'POST',\r\n            headers: {'Content-Type': 'application/json'},\r\n            body: JSON.stringify({username, password})\r\n        })\r\n        .then(response => {\r\n            setIsLoading(false);\r\n            return response.json();\r\n        })\r\n        .then(data => {\r\n            console.log(data);\r\n            if (data?.token) {\r\n                SaveUserInfo({username: data.username, token: data.token});\r\n                dispatch(userInfoActions.setUserInfo({username: data.username, token: data.token}));\r\n            } else if (data?.non_field_errors) {\r\n                console.log('error message', data.non_field_errors);\r\n                alert(data.non_field_errors);\r\n            }\r\n        });\r\n    }\r\n    \r\n    function onChange(event, type) {\r\n        if (type === \"username\")\r\n            setUsername(event.target.value);\r\n        else if (type === \"password\") \r\n            setPassword(event.target.value); \r\n    }\r\n\r\n    function VisitorSignIn(type) {\r\n        let username = undefined;\r\n        let password = undefined;\r\n        console.log(type); \r\n        if (type === 1) {\r\n            username = 'visitor1';\r\n            password = '123';\r\n        } else if  (type === 2) {\r\n            username = 'visitor2';\r\n            password = '123';\r\n        }\r\n        setIsLoading(true);\r\n        fetch( http_url + '/chat_app/api-token-auth/', {\r\n            method: 'POST',\r\n            headers: {'Content-Type': 'application/json'},\r\n            body: JSON.stringify({username, password})\r\n        })\r\n        .then(response => response.json())\r\n        .then(data => {\r\n            console.log(data);\r\n            setIsLoading(false);\r\n            if (data.token) {\r\n                SaveUserInfo({username: data.username, token: data.token});\r\n                dispatch(userInfoActions.setUserInfo({username: data.username, token: data.token}));\r\n            } else if (data.non_field_errors) {\r\n                console.log('error message', data.non_field_errors);\r\n                alert(data.non_field_errors);\r\n            }\r\n        });\r\n    }\r\n\r\n    return  (loggedIn? <Redirect to='/' /> \r\n    :\r\n    <div className='login'>\r\n        <form onSubmit={onSubmit} className='login-form'>\r\n            <TextField id=\"outlined-basic\" type=\"text\" placeholder=\"id\" autoComplete=\"username\" onChange={(event)=>onChange(event, 'username')} value={username} />\r\n            <TextField id=\"outlined-password-input\" type=\"password\" autoComplete=\"current-password\"  placeholder=\"password\" onChange={(event)=>onChange(event, 'password')} value={password} />\r\n            <Button variant=\"contained\" type=\"submit\">log in</Button>\r\n        </form>\r\n        <div>do not have an account yet?</div>\r\n        <div className='creat-new-account'><Button variant=\"contained\" onClick={()=>history.push('/register')}>Create a New Account</Button></div>\r\n        <div>want to try the app without registering?</div>\r\n        <div className = 'visitor-sign-in'><Button variant=\"contained\"  onClick={() => VisitorSignIn(1)}>sign in as visitor1</Button></div>\r\n        <div className = 'visitor-sign-in'><Button variant=\"contained\"  onClick={() => VisitorSignIn(2)}>sign in as visitor2</Button></div>\r\n        {isLoading&&<Spinner />}\r\n    </div>\r\n    );\r\n\r\n}\r\n\r\n","import React, { useState } from \"react\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport {SaveUserInfo} from \"../../others/shared_functions\";\r\nimport Spinner from '../Spinner/Spinner';\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\n\r\nimport {\r\n    Redirect,\r\n    useHistory\r\n  } from \"react-router-dom\";\r\n\r\nimport { http_url } from \"../../others/shared_vars\";\r\nimport { userInfoActions } from \"../../store/userInfo-slice\";\r\n\r\nexport default function Registration({loggedIn}) {\r\n    const history = useHistory();\r\n    const dispatch = useDispatch();\r\n\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [password2, setPassword2] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    \r\n    function onSubmit(event) {\r\n        event.preventDefault();\r\n        setIsLoading(true);\r\n        fetch( http_url + '/chat_app/registration', {\r\n            method: 'POST',\r\n            headers: {'Content-Type': 'application/json'},\r\n            body: JSON.stringify({username, password, password2})\r\n        })\r\n        .then(response => {\r\n            setIsLoading(false);\r\n            return response.json();})\r\n        .then(data => {\r\n            console.log(data);\r\n            let keys = Object.keys(data)\r\n            if (keys.find(key => key === \"token\")) {\r\n                SaveUserInfo({username: data.username, token: data.token});\r\n                dispatch(userInfoActions.setUserInfo({username: data.username, token: data.token}));\r\n            } else if (keys.find(key => key === \"error\")) {\r\n                console.log('error message', data.error);\r\n                alert(data.error);\r\n            }\r\n        });\r\n    }\r\n    \r\n    function onChange(event, type) {\r\n        if (type === \"username\")\r\n            setUsername(event.target.value);\r\n        else if (type === \"password\") \r\n            setPassword(event.target.value); \r\n        else if (type == \"password2\")\r\n            setPassword2(event.target.value); \r\n    }\r\n\r\n    if (loggedIn) return <Redirect to='/' />\r\n\r\n    return <>\r\n    <div className = \"registration\">\r\n    {isLoading&&<Spinner/>}\r\n        <form onSubmit={onSubmit}>\r\n            <TextField id=\"outlined-basic\" autoComplete=\"username\" placeholder=\"id\" onChange={(event)=>onChange(event, 'username')} value={username} />\r\n            <TextField id=\"outlined-password-input\" type=\"password\" autoComplete=\"new-password\" placeholder=\"password\" onChange={(event)=>onChange(event, 'password')} value={password} />\r\n            <TextField id=\"outlined-password-input 2\" type=\"password\" autoComplete=\"new-password\" placeholder=\"retype password\" onChange={(event)=>onChange(event, 'password2')} value={password2} />\r\n            <Button variant=\"contained\" type=\"submit\">register</Button>\r\n        </form> \r\n    <div>Already registered? <Button variant=\"contained\" onClick={()=>history.push('/login')}>Go to sign in page</Button></div>  \r\n    </div>\r\n    \r\n    </>;\r\n}\r\n\r\n\r\n","export default __webpack_public_path__ + \"static/media/x-lg.db763ca8.svg\";","export default __webpack_public_path__ + \"static/media/info.f4a46c68.svg\";","import { createSlice } from \"@reduxjs/toolkit\";\r\n\r\nfunction SortByTime(a, b) {\r\n  return (\r\n    new Date(b.last_message.time).getTime() -\r\n    new Date(a.last_message.time).getTime()\r\n  );\r\n}\r\n\r\nconst initialState = {\r\n  chats: [],\r\n  friends: [],\r\n  currentChat: null,\r\n  chatHistory: null,\r\n};\r\n\r\nconst statusSlice = createSlice({\r\n  name: \"status\",\r\n  initialState,\r\n  reducers: {\r\n    setChats(state, action) {\r\n      state.chats = action.payload.chats.sort(SortByTime);\r\n    },\r\n    addChat(state, action) {\r\n      state.chats.push(action.payload);\r\n    },\r\n    setFriends(state, action) {\r\n      state.friends = action.payload.friends;\r\n    },\r\n    addFriend(state, action) {\r\n      state.friends.push(action.payload);\r\n    },\r\n    setCurrentChat(state, action) {\r\n      state.currentChat = action.payload;\r\n    },\r\n    setChatHistory(state, action) {\r\n      state.chatHistory = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const statusActions = statusSlice.actions;\r\n\r\nexport default statusSlice;\r\n","import React from \"react\";\r\nimport './Friend.scss';\r\nimport {StringToColor} from '../../others/shared_functions';\r\nimport { Button } from \"@mui/material\";\r\n\r\nexport default function Friend ({friend, onClickFriend, checked, changeCheck, isFriend, addFriend}) {\r\n    \r\n    const style = {backgroundColor: StringToColor(friend)}; \r\n    \r\n    if (changeCheck || addFriend) {\r\n        return <>\r\n        <div className='friend additional-field' onClick = {() => onClickFriend(friend)}>\r\n            <div>\r\n                <div className='userIcon' style={style}>\r\n                    {friend[0]}\r\n                </div>\r\n                {friend}\r\n            </div>\r\n            {changeCheck&& <input type='checkbox' checked={checked} onChange={changeCheck} />}\r\n            {addFriend&& \r\n                <Button \r\n                    value={friend} \r\n                    disabled={isFriend} \r\n                    onClick={e=>addFriend(e)}\r\n                >\r\n                 {isFriend? 'added': 'add'} \r\n                 </Button>}\r\n        </div>\r\n    </>    \r\n    }\r\n    \r\n    return <>\r\n        <div className='friend' onClick = {() => onClickFriend(friend)}>\r\n            <div className='userIcon' style={style}>\r\n                {friend[0]}\r\n            </div>\r\n            {friend}\r\n        </div>\r\n    </>    \r\n}\r\n\r\n","import React from \"react\";\r\nimport { useSelector} from \"react-redux\";\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport Friend from '../Friend/Friend';\r\n\r\n\r\nexport default function ChatWindowModal(prop) {\r\n    const members = useSelector(state => state.status.chatHistory?.members);\r\n\r\n    if (!members) {\r\n        return null;\r\n    }; \r\n\r\n    return ( <>    \r\n    <Dialog\r\n        open={prop.modalOpen}\r\n        onClose={() => prop.setModalOpenProp(false)}\r\n        container={() => document.querySelector('.chat-window')}\r\n        style={{position: 'absolute'}}\r\n        BackdropProps={{ style: { position: 'absolute' } }}\r\n        componentsProps={{style: { padding: '100' }}}\r\n    >\r\n\r\n        <DialogTitle>members</DialogTitle>\r\n        {members.map(member => <Friend key={member} friend={member} onClickFriend = {() => {return} }/>)}\r\n\r\n    </Dialog>\r\n    </>\r\n    )\r\n}\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n    useParams,\r\n    useHistory,\r\n  } from \"react-router-dom\";\r\nimport TimeAgo from 'timeago-react';\r\nimport xIcon from \"../../icons/x-lg.svg\";\r\nimport infoIcon from \"../../icons/info.svg\";\r\nimport { MobileViewSide } from \"../../others/shared_functions\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport {statusActions} from \"../../store/status-slice\";\r\nimport TextField from '@mui/material/TextField';\r\nimport ChatWindowModal from '../ChatWindowModal/ChatWindowModal';\r\nimport {GetChatTitle} from '../../others/shared_functions';\r\nimport './ChatWindow.scss'\r\n\r\n\r\nexport default function ChatWindow({inputOn, socket, newChatData, mobileViewSide}) {\r\n\r\n    const { room_id } = useParams();\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const userInfo = useSelector(state => state.userInfo);\r\n    const chatHistory = useSelector(state => state.status.chatHistory);\r\n    const currentChat = useSelector(state=> state.status.currentChat);\r\n    const chats = useSelector(state => state.status.chats);\r\n\r\n    const [chatTitle, setChatTitle] = useState(null);\r\n    const [content, setContent] = useState('');\r\n    const scroll = useRef(null);\r\n    const [disabled, setDisabled] = useState(false);\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n\r\n    function setModalOpenProp (value) {\r\n        setModalOpen(value);\r\n    }\r\n\r\n    useEffect(()=> {\r\n        scroll.current.scrollTop = scroll.current.scrollHeight;\r\n    },[chatHistory])\r\n\r\n    useEffect(() => {\r\n        if (mobileViewSide) MobileViewSide(mobileViewSide);}\r\n    ,[mobileViewSide]);  \r\n\r\n    useEffect(()=>{\r\n    if (room_id) {\r\n        dispatch(statusActions.setCurrentChat(room_id));\r\n    }\r\n    else dispatch(statusActions.setCurrentChat(null));\r\n\r\n        return () =>{\r\n            dispatch(statusActions.setCurrentChat(null));\r\n        }\r\n    },[room_id, dispatch])\r\n\r\n    useEffect(()=>\r\n    {\r\n        if (newChatData?.groupName) {\r\n            setChatTitle(newChatData.groupName);\r\n        } else if(newChatData?.members) {\r\n            setChatTitle(newChatData.members[0]);\r\n        } else {\r\n            setChatTitle(GetChatTitle(currentChat, chats, userInfo));\r\n        }\r\n        \r\n    }, [currentChat, newChatData, chats, userInfo]\r\n    )\r\n\r\n    useEffect(() => {\r\n        if (newChatData?.members) {\r\n            let newChatMembers = [...newChatData.members, userInfo.username];\r\n            dispatch(statusActions.setCurrentChat({newChatMembers}));\r\n        }\r\n    }, [newChatData, userInfo.username, dispatch])\r\n\r\n    function sendMessage(e) {\r\n        e.preventDefault();\r\n        if(socket && room_id && content.trim().length) {\r\n            if(typeof socket === 'object'){\r\n                if (socket.url) socket.send(JSON.stringify({message: content, room_id}));  \r\n            }\r\n        } else if(socket && newChatData && content.trim().length) {\r\n            console.log(\"new chat sent: \", {...newChatData, message: content});\r\n            socket.send(JSON.stringify({...newChatData, message: content})); \r\n            setDisabled(false);        \r\n        }\r\n        setContent('');\r\n    }\r\n\r\n    function onChange(e) {\r\n        setContent(e.target.value);\r\n    }\r\n\r\n    const messages = chatHistory?.messages?.map(message => {\r\n        if (userInfo.username===message.sender) {\r\n            return (\r\n                <div key={message.time} className='message-block self'>\r\n                    <div className = 'container'>\r\n                        <div className='content'>\r\n                            {message.content}\r\n                        </div>\r\n                    </div>\r\n                    <div className='time'>\r\n                        <TimeAgo datetime={message.time}/>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (\r\n                <div key={message.time} className='message-block other'>\r\n                    <div className='sender'>\r\n                        {message.sender}\r\n                    </div>\r\n                    <div className='content'>\r\n                        {message.content}\r\n                    </div>\r\n                    <div className='time'>\r\n                        <TimeAgo datetime={message.time}/>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n    });\r\n\r\n    return (\r\n        <div className = {`right chat-window`}>\r\n            <div className = {`right-row1 chat-header`}>               \r\n                {(chatHistory || newChatData) && <>\r\n                    <div>\r\n                        <div className={`iconContainer xIconContainer`} onClick={()=>history.push('/')}> \r\n                            <img src={xIcon} className='icon' alt='X icon'/>\r\n                        </div>\r\n                        <div className='chatTitle'>\r\n                        {chatTitle}\r\n                        </div>\r\n                    </div>\r\n                    <div className='iconContainer' onClick={()=>setModalOpen(true)}> \r\n                        <img src={infoIcon} className='icon' alt='info icon'/>\r\n                    </div>\r\n                    </>}\r\n            </div>\r\n            <div className = 'right-row2' ref = {scroll}>\r\n                {messages?messages \r\n                : inputOn? <div className='greyed-out'>send a new message</div>\r\n                : <div className='greyed-out'>There are no messages to display. Please select a chat to display messages.</div>}\r\n            </div>\r\n            <div className = 'right-row3'>\r\n                {\r\n                    (messages||inputOn)&& \r\n                    <form onSubmit = {e => sendMessage(e)} autoComplete=\"off\">\r\n                        <div>\r\n                           <TextField id=\"outlined-basic\" variant=\"outlined\" type=\"text\" disabled={disabled} placeholder='Aa' value={content} onChange={e => onChange(e)} autoFocus={true}/>\r\n                        </div>\r\n                    </form>            \r\n                }\r\n            </div>\r\n            < ChatWindowModal \r\n                modalOpen={modalOpen}\r\n                setModalOpenProp={setModalOpenProp}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","export default __webpack_public_path__ + \"static/media/group-icon.eb244b39.svg\";","export default __webpack_public_path__ + \"static/media/arrow-left.83aa775a.svg\";","import React, { useState, useEffect} from \"react\";\r\nimport {\r\n  useHistory,\r\n  useLocation\r\n} from \"react-router-dom\";\r\nimport ChatWindow from \"../ChatWindow/ChatWindow\";\r\nimport Friend from \"../Friend/Friend\";\r\nimport { MobileViewSide } from \"../../others/shared_functions\";\r\nimport { useSelector} from \"react-redux\";\r\nimport xIcon from \"../../icons/x-lg.svg\";\r\nimport groupIcon from \"../../icons/group-icon.svg\";\r\nimport  {Button, TextField }  from '@mui/material';\r\nimport arrowLeftIcon from \"../../icons/arrow-left.svg\";\r\nimport './NewChat.scss'\r\nimport { QueryStringGenerator } from \"../../others/shared_functions\"; \r\n\r\nconst sections = ['new_message','add_participants','add_title', 'send_message'];\r\n\r\nexport default function NewChat ({ socket, onClickFriend,  mobileViewSide}) {\r\n\r\n  const location = useLocation();\r\n  const history = useHistory();\r\n  const friends = useSelector(state => state.status.friends);\r\n\r\n  let queryParams = new URLSearchParams(location.search);\r\n  let queryParamsSection = queryParams.get('section')? queryParams.get('section').trim() : '';\r\n  let queryParamsMembers = queryParams.getAll('members');\r\n  let queryParamsGroupName = queryParams.get('group_name')? queryParams.get('group_name').trim() : '';\r\n\r\n  if (!sections.includes(queryParamsSection)) {\r\n    queryParamsSection = 'new_message';\r\n  }\r\n\r\n  switch(queryParamsSection) {\r\n    case 'new_message':\r\n      queryParamsMembers = [];\r\n      queryParamsGroupName = '';\r\n      break;\r\n    case 'send_message':\r\n\r\n      queryParamsMembers = queryParamsMembers.filter(member => friends.includes(member));\r\n\r\n      if (!queryParamsGroupName && queryParamsMembers.length === 1) {\r\n        // need to check if a chat room already exists for the member\r\n        break; \r\n      } else if (queryParamsGroupName && queryParamsMembers.length > 1) {\r\n        console.log('yes!!')\r\n        break\r\n      } else {\r\n        queryParamsSection = 'new_message';\r\n        queryParamsMembers = [];\r\n      }\r\n      break;\r\n    default:\r\n      queryParamsMembers = queryParamsMembers.filter(member => friends.includes(member));  \r\n  }\r\n\r\n  console.log('\\nsection is', queryParamsSection);\r\n\r\n  const [section, setSection] = useState(queryParamsSection);\r\n  const [groupName, setGroupName] = useState(queryParamsGroupName);\r\n  const [checkedUsers, setCheckedUsers] = useState(queryParamsMembers);\r\n\r\n  const [newChatData, setNewChatData] = useState({\r\n    newChat: true,\r\n    groupName: null,\r\n    members: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const queryParams = new URLSearchParams(location.search);\r\n    let queryParamsSection = queryParams.get('section')? queryParams.get('section').trim() : '';\r\n    let queryParamsMembers = queryParams.getAll('members');\r\n    let queryParamsGroupName = queryParams.get('group_name')? queryParams.get('group_name').trim() : '';\r\n  \r\n    if (!sections.includes(queryParamsSection)) {\r\n      queryParamsSection = 'new_message'\r\n    }\r\n  \r\n    switch(queryParamsSection) {\r\n      case 'new_message':\r\n        queryParamsMembers = [];\r\n        queryParamsGroupName = '';\r\n        break;\r\n      case 'send_message':\r\n        \r\n        queryParamsMembers = queryParamsMembers.filter(member => friends.includes(member));\r\n\r\n        if (!queryParamsGroupName && queryParamsMembers.length === 1) {\r\n          // need to check if a chat room already exists for the member\r\n          break; \r\n        } else if (queryParamsGroupName && queryParamsMembers.length > 1) {\r\n          console.log('yes!!')\r\n          break\r\n        } else {\r\n          queryParamsSection = 'new_message';\r\n          queryParamsMembers = [];\r\n        }\r\n        break;\r\n      default:\r\n        queryParamsMembers = queryParamsMembers.filter(member => friends.includes(member));  \r\n    }\r\n\r\n    setSection(queryParamsSection);\r\n    setGroupName(queryParamsGroupName);\r\n    setCheckedUsers(queryParamsMembers);\r\n\r\n  }, [location.search, friends])\r\n\r\n  useEffect(() => {\r\n    setNewChatData( (prev) => {return {...prev, groupName, members: checkedUsers}})\r\n  }, [checkedUsers, groupName])\r\n\r\n\r\n  useEffect(() => {\r\n    if (mobileViewSide) MobileViewSide(mobileViewSide);}\r\n    ,[mobileViewSide]);  \r\n\r\n\r\n  function ChangeCheck(user) {\r\n    if (checkedUsers.find(e => e == user)) {\r\n      console.log(user, 'unchecking')\r\n      setCheckedUsers(checkedUsers.filter(e => e !== user));\r\n    } else {\r\n      console.log(user, 'checking')\r\n      setCheckedUsers(checkedUsers.concat([user]));\r\n    }\r\n  }\r\n\r\n  useEffect(()=>{\r\n    MobileViewSide('right');\r\n  },[section]);\r\n\r\n\r\n  function JumpToSendMessage(e) {\r\n    e.preventDefault();\r\n    if (!groupName?.trim()) return;\r\n    history.push(\"newchat?\" + QueryStringGenerator('send_message', checkedUsers, groupName, friends));\r\n  }\r\n\r\n  const new_message = (\r\n    <div className='NewChat right'>\r\n      <div className='right-row1'>\r\n        <div className='iconContainer xIconContainer' onClick={()=>history.push('/')}> \r\n            <img src={xIcon} className='icon' alt=\"x icon\"/>\r\n        </div>\r\n        <div >\r\n          New message\r\n        </div>\r\n      </div>\r\n      <div className='right-row2'>\r\n        <div className = 'create-new-group' onClick={()=>history.push('/newchat?section=add_participants')}>\r\n          <div className='iconContainer group'> \r\n              <img src={groupIcon} className='icon' alt=\"group icon\"/>\r\n          </div>\r\n          <div >\r\n            Create a New Group\r\n          </div>\r\n        </div>\r\n        <div className=\"suggested\">\r\n          Suggested:\r\n        </div>\r\n        {friends?.map(friend => { return (\r\n          <Friend friend = {friend} onClickFriend={onClickFriend}/>\r\n        );})}\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const add_participants = (\r\n    <div className='NewChat AddParticipants right'>\r\n      <div className='right-row1'>\r\n        <div>\r\n          <div className='iconContainer' onClick={() => history.push('/newchat?section=new_message')}> \r\n              <img src={arrowLeftIcon} className='icon' alt=\"left arrow\"/>\r\n          </div>\r\n          Add Participants\r\n        </div>\r\n        <Button id='next-button' onClick={()=> history.push('/newchat?' + QueryStringGenerator('add_title', checkedUsers, null, friends))} disabled={checkedUsers.length < 2}>\r\n          NEXT\r\n        </Button>       \r\n      </div>\r\n      <div className='right-row2'>\r\n        {friends?.map(friend => {\r\n          return (<>\r\n            <div className='friend-checkbox-container'>\r\n              <Friend \r\n              friend = {friend}  \r\n              onClickFriend = {() => null}\r\n              checked={checkedUsers.find(user => user === friend)} \r\n              changeCheck={() => ChangeCheck(friend)}\r\n              />\r\n            </div>\r\n            </>);})}\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const add_title = (\r\n    <div className = 'NewChat AddTitle right'>\r\n      <div className='right-row1'>\r\n        <div>\r\n            <div className='iconContainer' onClick={() => history.push(\"/newchat?section=add_participants\")}> \r\n                <img src={arrowLeftIcon} className='icon' alt='left arrow'/>\r\n            </div>\r\n            Add Title\r\n          </div>\r\n          <Button id='create-button' onClick={()=> history.push('/newchat?' + QueryStringGenerator('send_message', checkedUsers, groupName, friends))} disabled={!groupName.trim()}>\r\n            CREATE\r\n          </Button> \r\n\r\n      </div>\r\n      <div className='right-row2'>\r\n        <form id=\"form1\"  onSubmit={(e)=>{JumpToSendMessage(e)}}>\r\n          <div className='text-field-container'>\r\n            <TextField variant=\"standard\" type='text' placeholder='Group Name (Required)' required=\"required\" value={groupName} onChange={e=>setGroupName(e.target.value)} />\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n    \r\n  const send_message = <>\r\n    <ChatWindow \r\n    inputOn={true} \r\n    newChatData={newChatData}\r\n    socket={socket}\r\n    />\r\n  </>;\r\n    \r\n  const page = \r\n  section === 'new_message'? new_message\r\n  : section === 'add_participants'? add_participants\r\n  : section === 'add_title'? add_title\r\n  : section === 'send_message'? send_message\r\n  : null; \r\n\r\n  return page; \r\n  }\r\n  \r\n  ","import React, { useState, useEffect} from \"react\";\r\nimport {\r\n  useHistory\r\n} from \"react-router-dom\";\r\nimport Friend from \"../Friend/Friend\";\r\nimport { MobileViewSide } from \"../../others/shared_functions\";\r\nimport { http_url} from \"../../others/shared_vars\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { statusActions } from \"../../store/status-slice\";\r\nimport xIcon from \"../../icons/x-lg.svg\"\r\nimport  {TextField }  from '@mui/material';\r\nimport './AddFriend.scss'\r\n\r\n\r\nexport default function AddFriend () {\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    dispatch(statusActions.setChatHistory(null));\r\n\r\n    const [query, setQuery] = useState(undefined);\r\n    const [suggestions, setSuggestions] = useState(undefined);\r\n    const history = useHistory();\r\n    const userInfo = useSelector(state => state.userInfo);\r\n\r\n    useEffect(()=>{\r\n        MobileViewSide('right');\r\n    }, [])\r\n\r\n    useEffect(()=>{\r\n        fetch( http_url + '/chat_app/add_friend?' + new URLSearchParams({username: query}), {\r\n            method: 'GET',\r\n            headers: {'Content-Type': 'application/json', 'Authorization': 'token '+ userInfo.token,},\r\n        })\r\n        .then(response => {\r\n            if (response.ok) return response.json()\r\n            else return null\r\n        })\r\n        .then(data => {\r\n            console.log(data);\r\n            setSuggestions(data);\r\n        });   \r\n    }\r\n    ,[query, userInfo.token])\r\n\r\n    function onChange(e) {\r\n        setQuery(e.target.value);\r\n    }\r\n\r\n    function onSubmit(e) {\r\n        e.preventDefault();\r\n        fetch( http_url + '/chat_app/add_friend?' + new URLSearchParams({username: query}), {\r\n            method: 'GET',\r\n            headers: {'Content-Type': 'application/json', 'Authorization': 'token '+ userInfo.token,},\r\n        })\r\n        .then(response => {\r\n            if (response.ok) return response.json()\r\n            else return null\r\n        })\r\n        .then(data => {\r\n            console.log(data);\r\n            setSuggestions(data);\r\n        });\r\n    }\r\n\r\n    function onClick(e) {\r\n        let username = e.target.value;\r\n        let new_suggestion;\r\n        fetch( http_url + '/chat_app/add_friend', {\r\n            method: 'POST',\r\n            headers: {'Content-Type': 'application/json', 'Authorization': 'token '+ userInfo.token},\r\n            body: JSON.stringify({username})\r\n        })\r\n        .then(response => {console.log(response.status, response.ok); if (response.ok)response.json()})\r\n        .then(data => {\r\n            console.log(data);\r\n            new_suggestion = suggestions.map(suggestion => {\r\n                if (suggestion.username === username) return {username, isFriend: true}\r\n                return suggestion;\r\n            })\r\n            setSuggestions(new_suggestion);\r\n            dispatch(statusActions.addFriend(username));\r\n        });\r\n    } \r\n \r\n    const searchResult = <div className=\"right-row2>\">\r\n        {suggestions?.map(suggestion => <>\r\n            <Friend \r\n            friend={suggestion.username}\r\n            onClickFriend={()=>null}\r\n            isFriend={suggestion.isFriend}\r\n            addFriend={onClick}\r\n            />\r\n        </>\r\n        )}\r\n    </div>;\r\n\r\n    return <>\r\n    <div className=\"right add-friend\">\r\n        <div className=\"right-row1\">\r\n            <div className='iconContainer xIconContainer' onClick={()=>history.push('/')}> \r\n                <img src={xIcon} className='icon' alt='X'/>\r\n            </div>\r\n            <div >\r\n                Add friends\r\n            </div>\r\n        </div>\r\n        <div className='right-row2'>\r\n            <form onSubmit={e => onSubmit(e)}>\r\n                <div className='text-field-container'>\r\n                    <TextField variant=\"standard\" type='text' placeholder='search by username' required=\"required\" value={query}  onChange = {e=>onChange(e)} />\r\n                </div>\r\n            </form>\r\n        {searchResult}\r\n        </div>\r\n    </div>\r\n    </>;\r\n\r\n}","import React from \"react\";\r\nimport {\r\n    useHistory,\r\n  } from \"react-router-dom\";\r\n\r\nimport {StringToColor} from '../../others/shared_functions';\r\nimport { useSelector } from \"react-redux\";\r\nimport './Chat.scss';\r\n\r\n\r\nfunction formatTime(timeInput) {\r\n  const current = new Date();\r\n  const time = new Date(timeInput);\r\n  const monthMap = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n  const month = monthMap[time.getMonth()];\r\n\r\n  if (current.getFullYear() !== time.getFullYear()) return `${month} ${time.getDate()} ${time.getFullYear()}`\r\n  else if (current.getMonth() !== time.getMonth()) return `${month} ${time.getDate()}`;\r\n  else if (current.getDate() === time.getDate()) {\r\n    if (time.getHours() === 0) return `${12}:${time.getMinutes()} AM`;\r\n    else if (time.getHours() < 12) return `${time.getHours()}:${time.getMinutes()} AM`;\r\n    else if (time.getHours() === 12) return `${time.getHours()}:${time.getMinutes()} PM`;\r\n    return `${time.getHours()-12}:${time.getMinutes()} PM`;\r\n  }\r\n  return `${month} ${time.getDate()}`;\r\n}\r\n\r\n\r\nexport default function Chat({chat}) {\r\n    const history = useHistory();\r\n    const userInfo = useSelector(state => state.userInfo);\r\n    const path = \"/room/\" + chat.id;\r\n    const chatName = chat.name? chat.name \r\n    : chat.members?.length === 2 ? chat.members.find(member => member !== userInfo.username)\r\n    : undefined;\r\n\r\n    let otherMembers = chat?.members.filter(member => member !== userInfo.username);\r\n    \r\n    if (otherMembers?.length > 1) otherMembers = otherMembers.slice(0, 2);\r\n \r\n\r\n    return <>\r\n      <div className='chat' onClick={()=>history.push(path)}>      \r\n        {otherMembers.length > 1 ? (\r\n          <div className = 'userIcon group'> \r\n          {otherMembers.map(member => <div key={member} className='userIcon small' style = {{backgroundColor: StringToColor(member)}}> {member[0]} </div>)}\r\n          </div>\r\n          )\r\n        : otherMembers.map(member => \r\n        <div key={member} className='userIcon' style = {{backgroundColor: StringToColor(member)}}> \r\n          {member[0]} \r\n        </div>)}\r\n        <div style={{overflow: 'hidden'}}>\r\n          <div>{chatName}</div>\r\n          <div className='detail'>\r\n            <div className='content'>{chat.last_message?.content}</div>\r\n            \r\n            {chat.last_message?.time && \r\n              <div className='time'> &nbsp;{`· ${formatTime(chat.last_message.time)}`}</div>\r\n            }\r\n      \r\n          </div> \r\n\r\n        </div>\r\n        \r\n      </div>\r\n    </>\r\n}","import React from \"react\";\r\nimport Friend from \"../Friend/Friend\"\r\nimport Chat from \"../Chat/Chat\"\r\nimport { useSelector} from \"react-redux\";\r\n\r\n\r\nexport default function ChatPeopleList({showChat, setChatHistoryProp, onClickFriend}) {\r\n\r\n   const chats = useSelector(state => state.status.chats);\r\n   const friends = useSelector(state => state.status.friends);\r\n\r\n   if (showChat) {\r\n      if (chats?.length) {\r\n         return chats.map(chat => {\r\n            return <Chat key={chat.id} chat = {chat} setChatHistoryProp = {setChatHistoryProp}/>\r\n         });     \r\n      } \r\n      return 'no chats exist for the user yet';\r\n   } \r\n   \r\n   if (friends?.length) {\r\n      return friends.map(friend => {\r\n         return <Friend key={friend} friend = {friend} onClickFriend={onClickFriend}/>\r\n      })\r\n   }\r\n   return 'no friends exist for the user yet';\r\n}\r\n\r\n","export default __webpack_public_path__ + \"static/media/chat-fill.c06d5871.svg\";","export default __webpack_public_path__ + \"static/media/people-fill.1ec4cb9a.svg\";","import React from \"react\";\r\nimport './ChatPeopleToggle.css'; \r\nimport chat_fill from '../../icons/chat-fill.svg'\r\nimport people_fill from '../../icons/people-fill.svg'\r\n\r\nexport default function ChatPeopleToggle({ChatPeopleSwitch}) {\r\n\r\n    return <div className = 'ChatPeopleToggle'>\r\n        <div onClick={() => ChatPeopleSwitch(true)}>\r\n            <img className='chat_fill' src={chat_fill} alt=\"Chat logo\"/>\r\n            <div>Chat</div>\r\n        </div>\r\n        <div onClick={() => ChatPeopleSwitch(false)}>\r\n            <img className='people_fill' src={people_fill} alt=\"People logo\"/>\r\n            <div>People</div>\r\n        </div>\r\n    </div>;\r\n}","export default __webpack_public_path__ + \"static/media/log-out.a1f930e4.svg\";","export default __webpack_public_path__ + \"static/media/pencil-fill.8f9e674f.svg\";","export default __webpack_public_path__ + \"static/media/person-plus-fill.57f5c296.svg\";","import ChatPeopleList from \"../ChatPeopleList/ChatPeopleList\";\r\nimport ChatPeopleToggle from \"../ChatPeopleToggle/ChatPeopleToggle\";\r\nimport React, { useState} from \"react\";\r\nimport {\r\n  useHistory,\r\n} from \"react-router-dom\";\r\nimport { SaveUserInfo, StringToColor } from \"../../others/shared_functions\";\r\nimport logoutIcon from \"../../icons/log-out.svg\";\r\nimport pencilIcon from \"../../icons/pencil-fill.svg\";\r\nimport personPlusIcon from \"../../icons/person-plus-fill.svg\";\r\nimport xIcon from \"../../icons/x-lg.svg\";\r\nimport { http_url } from \"../../others/shared_vars\";\r\nimport { useSelector} from \"react-redux\";\r\nimport './Main.scss';\r\n\r\nexport default function Main ({setChatHistoryProp, rooms, onClickFriend}) {\r\n  const history = useHistory();\r\n  const userInfo = useSelector(state => state.userInfo);\r\n  const [showChat, setShowChat] = useState(true);\r\n\r\n  function ChatPeopleSwitch(value) {\r\n    setShowChat(value);\r\n  }\r\n\r\n  function logout(){\r\n    SaveUserInfo();\r\n    fetch(http_url + '/chat_app/logout', \r\n    {\r\n      headers: {\r\n        'authorization': \"token \" + userInfo.token,\r\n        'Content-Type': 'application/json',\r\n      },\r\n    })\r\n    .then(response => response.json())\r\n    .then(data => {\r\n      console.log('logged out');\r\n      console.log(data);\r\n      window.location.reload();\r\n    }).catch(error => console.error(error));\r\n  }\r\n\r\n  const profilePage = \r\n    <div className = 'profile-page'>\r\n      <div className = 'profile-header'>\r\n        <div className = 'profile-header-left'>\r\n          <div className='iconContainer' onClick={()=>ProfileOn(false)}>\r\n            <img src={xIcon} className='icon' alt='X icon' />\r\n          </div>\r\n          <div>\r\n            Me\r\n          </div>\r\n        </div>\r\n        <div className='iconContainer' onClick={async () => await logout()}>\r\n          <img src={logoutIcon} className='icon' alt='log out'/>\r\n        </div>\r\n      </div>\r\n      <div className='userIcon large' style={{backgroundColor: StringToColor(userInfo.username)}}>\r\n        {userInfo.username[0]}\r\n      </div>\r\n      <div className = 'profile-username'>\r\n        {userInfo.username}\r\n      </div>\r\n\r\n    </ div>;\r\n  \r\n  function ProfileOn(state) {\r\n    let profile = document.querySelector('.profile-page');\r\n    if (state) profile.style.display = 'block';\r\n    else profile.style.display = 'none';\r\n  }\r\n\r\n  return (\r\n    <div className = 'left Main'>\r\n      {profilePage}\r\n      <div className='left-row1'>\r\n        <div className = \"Header\">\r\n          <div className = 'Header-left'>\r\n            <div className='userIcon' style={{backgroundColor: StringToColor(userInfo.username)}} onClick={()=>ProfileOn(true)}>\r\n                {userInfo.username[0]}\r\n            </div>\r\n            {showChat? 'Chats' : 'People'}\r\n          </div>\r\n          <div className='buttons'>\r\n            <div className='iconContainer' onClick={()=>history.push('/addfriend')}>\r\n              <img src={personPlusIcon} className='icon' alt='add friend icon' />\r\n            </div>\r\n            <div className='iconContainer' onClick={()=>history.push('/newchat?section=new_message')}>\r\n              <img src={pencilIcon} className='icon' alt='pencil icon'/>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n        <div className='left-row2'>\r\n          <ChatPeopleList onClickFriend={onClickFriend} showChat={showChat} setChatHistoryProp={setChatHistoryProp} rooms={rooms}/> \r\n        </div>\r\n        <div className='left-row3'>\r\n          <ChatPeopleToggle ChatPeopleSwitch={ChatPeopleSwitch}/>\r\n        </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","import { configureStore } from \"@reduxjs/toolkit\";\r\n\r\n// import counterReducer from \"./counter\";\r\n// import authReducer from \"./auth\";\r\nimport userInfoSlice from \"./userInfo-slice\";\r\nimport statusSlice from \"./status-slice\";\r\n\r\nconst store = configureStore({\r\n  reducer: {\r\n    userInfo: userInfoSlice.reducer,\r\n    status: statusSlice.reducer,\r\n  },\r\n});\r\n\r\nexport default store;\r\n","import \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./App.css\";\r\nimport Login from \"./components/Login/Login\";\r\nimport Registration from \"./components/Registration/Registration\";\r\nimport NewChat from \"./components/NewChat/NewChat\";\r\nimport AddFriend from \"./components/AddFriend/AddFriend\";\r\nimport Spinner from \"./components/Spinner/Spinner\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Route, Redirect, useHistory } from \"react-router-dom\";\r\nimport ChatWindow from \"./components/ChatWindow/ChatWindow\";\r\nimport Main from \"./components/Main/Main\";\r\nimport { http_url, ws_url } from \"./others/shared_vars\";\r\nimport { w3cwebsocket as W3CWebSocket } from \"websocket\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { fetchUserInfo, GeneralUpdate } from \"./store/userInfo-actions\";\r\nimport { statusActions } from \"./store/status-slice\";\r\n\r\nexport default function App() {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n\r\n  const userInfo = useSelector((state) => state.userInfo);\r\n  const chats = useSelector((state) => state.status.chats);\r\n  const currentChat = useSelector((state) => state.status.currentChat);\r\n  const chatHistory = useSelector((state) => state.status.chatHistory);\r\n\r\n  const [socket, setSocket] = useState({});\r\n\r\n  // open and close socket\r\n  useEffect(() => {\r\n    if (!userInfo.token) {\r\n      return;\r\n    }\r\n    dispatch(GeneralUpdate());\r\n    const tempSocket = new W3CWebSocket(\r\n      ws_url + \"/ws/chat/?token=\" + userInfo.token\r\n    );\r\n    setSocket(tempSocket);\r\n\r\n    return () => {\r\n      if (\"close\" in tempSocket) {\r\n        console.log(\"closing socket\", tempSocket);\r\n        tempSocket.close();\r\n        setSocket({});\r\n      }\r\n    };\r\n  }, [userInfo.token, dispatch]);\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchUserInfo());\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (currentChat && userInfo.token) {\r\n      // used for setting chat info just before sending a new message to create a new chat\r\n      // if (\"newChatMembers\" in currentChat) {\r\n      if (Object.keys(currentChat).find((key) => key === \"newChatMembers\")) {\r\n        let members = [...currentChat.newChatMembers];\r\n        dispatch(statusActions.setChatHistory({ members }));\r\n        return;\r\n      }\r\n\r\n      fetch(http_url + \"/chat_app/chat_update/\" + currentChat, {\r\n        headers: { authorization: \"token \" + userInfo.token },\r\n      })\r\n        .then((response) => {\r\n          if (response.ok) return response.json();\r\n          else {\r\n            history.replace(\"/\");\r\n          }\r\n        })\r\n        .then((data) => dispatch(statusActions.setChatHistory(data)))\r\n        .catch((error) => console.error(error));\r\n    } else dispatch(statusActions.setChatHistory(null));\r\n  }, [currentChat, userInfo, dispatch, history]);\r\n\r\n  useEffect(() => {\r\n    let updatedChats;\r\n    if (socket.url) {\r\n      socket.onopen = () => {\r\n        console.log(\"connected to websocket\");\r\n      };\r\n\r\n      socket.onmessage = (e) => {\r\n        console.log(\"onmessage via websocket\");\r\n        const data = JSON.parse(e.data);\r\n        console.log(data);\r\n\r\n        if (data.newChat && data.room) {\r\n          dispatch(statusActions.addChat(data.room));\r\n          console.log(\"new room added\", data.room);\r\n          if (data.sender === userInfo?.username)\r\n            history.replace(`room/${data.room.id}`);\r\n        } else if (data.message.room_id == currentChat && chatHistory) {\r\n          dispatch(\r\n            statusActions.setChatHistory({\r\n              ...chatHistory,\r\n              messages: [...chatHistory.messages, data.message],\r\n            })\r\n          );\r\n          updatedChats = chats.map((e) => {\r\n            if (e.id == data.message.room_id) {\r\n              return {\r\n                ...e,\r\n                last_message: {\r\n                  time: data.message.time,\r\n                  content: data.message.content,\r\n                  checked: false,\r\n                },\r\n              };\r\n            }\r\n            return e;\r\n          });\r\n          dispatch(statusActions.setChats({ chats: updatedChats }));\r\n          console.log(\"new message appended\");\r\n        } else {\r\n          updatedChats = chats.map((e) => {\r\n            if (e.id == data.message.room_id) {\r\n              return {\r\n                ...e,\r\n                last_message: {\r\n                  time: data.message.time,\r\n                  content: data.message.content,\r\n                  checked: false,\r\n                },\r\n              };\r\n            }\r\n            return e;\r\n          });\r\n          dispatch(statusActions.setChats({ chats: updatedChats }));\r\n        }\r\n      };\r\n    }\r\n    // return () => {\r\n    //   console.log(\"resetting socket onopen and onmessage\");\r\n    //   socket.onopen = () => null;\r\n    //   socket.onmessage = () => null;\r\n    // };\r\n  }, [socket, currentChat, chatHistory, chats, userInfo, dispatch, history]);\r\n\r\n  function onClickFriend(user) {\r\n    let chat_id = chats?.find(\r\n      (chat) =>\r\n        chat.members.length === 2 &&\r\n        chat.members.find((member) => member === user)\r\n    )?.id;\r\n\r\n    if (chat_id) {\r\n      history.push(`/room/${chat_id}`);\r\n    } else {\r\n      console.log(\"redirect\", chat_id);\r\n      history.push(`/newchat?section=send_message&members=${user}`);\r\n    }\r\n  }\r\n\r\n  if (userInfo.isLoading) {\r\n    return (\r\n      <>\r\n        <Spinner />\r\n        <div>it may take up to 20 seconds to load the app...</div>\r\n      </>\r\n    );\r\n  } else if (!userInfo.token) {\r\n    return (\r\n      <>\r\n        <Route path=\"/login\">\r\n          <Login userInfo={null} />\r\n        </Route>\r\n        <Route path=\"/register\">\r\n          <Registration userInfo={null} />\r\n        </Route>\r\n        <Route path=\"/\">\r\n          <Redirect to=\"/login\" />\r\n        </Route>\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Main mobileViewSide={\"left\"} onClickFriend={onClickFriend} />\r\n      <Route exact path=\"/\">\r\n        {userInfo.token ? (\r\n          <ChatWindow mobileViewSide={\"left\"} />\r\n        ) : (\r\n          <Redirect to=\"/login\" />\r\n        )}\r\n      </Route>\r\n      <Route path=\"/room/:room_id\">\r\n        <ChatWindow socket={socket} mobileViewSide={\"right\"} />\r\n      </Route>\r\n      <Route path=\"/newchat\">\r\n        <NewChat\r\n          socket={socket}\r\n          onClickFriend={onClickFriend}\r\n          mobileViewSide={\"right\"}\r\n        />\r\n      </Route>\r\n      <Route path=\"/addfriend\">\r\n        <AddFriend mobileViewSide={\"right\"} />\r\n      </Route>\r\n      <Route path=\"/login\">\r\n        <Login loggedIn={true} />\r\n      </Route>\r\n      <Route path=\"/register\">\r\n        <Registration loggedIn={true} />\r\n      </Route>\r\n    </>\r\n  );\r\n}\r\n","import { userInfoActions } from \"./userInfo-slice\";\r\nimport { statusActions } from \"./status-slice\";\r\nimport { http_url } from \"../others/shared_vars\";\r\nimport store from \"./index\";\r\n\r\nexport const fetchUserInfo = () => {\r\n  return async (dispatch) => {\r\n    if (typeof Storage === \"undefined\") {\r\n      console.log(\"storage undefined\");\r\n      dispatch(\r\n        userInfoActions.setUserInfo({\r\n          username: null,\r\n          token: null,\r\n          isLoading: false,\r\n        })\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!localStorage.ChatUserInfo) {\r\n      console.log(\"localStorage.ChatUserInfo is undefined\");\r\n      dispatch(\r\n        userInfoActions.setUserInfo({\r\n          username: null,\r\n          token: null,\r\n          isLoading: false,\r\n        })\r\n      );\r\n    }\r\n\r\n    const fetchData = async (storedInfo) => {\r\n      console.log(\"stored info\", storedInfo);\r\n      const response = await fetch(http_url + \"/chat_app/user_check\", {\r\n        method: \"GET\",\r\n        headers: { Authorization: \"token \" + storedInfo.token },\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error(\"Could not fetch user info!\");\r\n      }\r\n\r\n      const data = await response.json();\r\n\r\n      if (!data.username) {\r\n        throw new Error(\"user check failed\");\r\n      }\r\n\r\n      return data;\r\n    };\r\n\r\n    const storedInfo = JSON.parse(localStorage.ChatUserInfo);\r\n\r\n    try {\r\n      const userData = await fetchData(storedInfo);\r\n      console.log(\"userData\", userData);\r\n      dispatch(\r\n        userInfoActions.setUserInfo({\r\n          username: userData.username,\r\n          token: storedInfo.token,\r\n          isLoading: false,\r\n        })\r\n      );\r\n    } catch (error) {\r\n      console.error(error.message, \"fetchUserInfo failed\");\r\n\r\n      dispatch(\r\n        userInfoActions.setUserInfo({\r\n          username: null,\r\n          token: null,\r\n          isLoading: false,\r\n        })\r\n      );\r\n    }\r\n  };\r\n};\r\n\r\nexport const GeneralUpdate = () => {\r\n  return async (dispatch) => {\r\n    const state = store.getState();\r\n    console.log(\"general update state\", state);\r\n    const fetchData = async () => {\r\n      const response = await fetch(http_url + \"/chat_app/general_update\", {\r\n        method: \"GET\",\r\n        headers: { Authorization: \"token \" + state.userInfo.token },\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"GeneralUpdate failed\");\r\n\r\n      const data = await response.json();\r\n      return data;\r\n    };\r\n\r\n    try {\r\n      console.log(\"\\n\\n\\n general update \\n\\n\\n\");\r\n      const data = await fetchData();\r\n      console.log(data.rooms);\r\n      console.log(data.friends);\r\n      dispatch(\r\n        statusActions.setChats({\r\n          chats: data.rooms,\r\n        })\r\n      );\r\n      dispatch(\r\n        statusActions.setFriends({\r\n          friends: data.friends,\r\n        })\r\n      );\r\n    } catch (error) {\r\n      console.error(error.message, \"GeneralUpdate failed\");\r\n    }\r\n  };\r\n};\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport { Switch, HashRouter } from \"react-router-dom\";\r\nimport store from \"./store/index.js\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <HashRouter>\r\n      <Provider store={store}>\r\n        <div className=\"App\">\r\n          <Switch>\r\n            <App />\r\n          </Switch>\r\n        </div>\r\n      </Provider>\r\n    </HashRouter>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}